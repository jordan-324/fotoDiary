<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Photo Diary • Viewer</title>
    <link rel="stylesheet" href="/style.css">
    

  </head>
  <body>
    <main>
      <header>
        <h1>photo—diary</h1>
      </header>
      <section id="gallery"></section>
      <p id="empty" hidden>No uploads yet.</p>
     
     
      
    </main>
    <script>
      async function load() {
        const res = await fetch('/list');
        if (!res.ok) {
          document.getElementById('empty').textContent = 'Failed to load list';
          document.getElementById('empty').hidden = false;
          return;
        }
        const json = await res.json();
        const files = json.files || [];
        const gallery = document.getElementById('gallery');
        const empty = document.getElementById('empty');
        gallery.innerHTML = '';
        if (!files.length) {
          empty.hidden = false;
          return;
        }
        empty.hidden = true;
        const item = document.createElement('article');
        item.className = 'card';
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.textContent = 'invade';
        btn.addEventListener('click', () => {
          const idx = Math.floor(Math.random() * files.length);
          const chosen = files[idx];
          const u = new URL('/photo.html', window.location.origin);
          u.searchParams.set('f', chosen);
          window.location.href = u.toString();
        });
        const name = document.createElement('div');
        name.className = 'name';
        name.textContent = `count — ${files.length}`;
        item.appendChild(btn);
        item.appendChild(name);
        gallery.appendChild(item);
      }
      load();
    </script>
  </body>
  </html>
